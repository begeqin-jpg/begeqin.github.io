<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Donate with PayPal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<body style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;">
  <div style="text-align:center;">
    <h2>Pay securely with PayPal</h2>

    <!-- Поле ввода суммы -->
    <input
      id="amount"
      type="number"
      value="10"
      min="1"
      step="0.01"
      style="padding:10px;font-size:16px;margin-bottom:15px;width:180px;text-align:center;"
      placeholder="Amount (USD)"
    />

    <div id="paypal-button-container"></div>
  </div>

  <!-- PayPal SDK: оставляем ТОЛЬКО PayPal (без Debit/Credit Card и Pay Later) -->
  <script src="https://www.paypal.com/sdk/js?client-id=BAAckpuoQtuQv2bX_6xePLrMM-4eAISQLU61urj-19yqBSYaBLnNNDNxiF_3f2kTCWiDyNDuI98KRRSZXY&currency=USD&disable-funding=card,credit,paylater"></script>

  <script>
    paypal.Buttons({
      // Принудительно показываем именно кнопку PayPal
      fundingSource: paypal.FUNDING.PAYPAL,

      createOrder: function (data, actions) {
        let amount = document.getElementById('amount').value;

        // Нормализуем значение
        amount = (amount || '').toString().trim();

        // Мини-проверки
        const num = Number(amount);
        if (!amount || Number.isNaN(num) || num <= 0) {
          alert('Please enter a valid amount (e.g., 5 or 10.50).');
          throw new Error('Invalid amount');
        }

        // PayPal ожидает строку с 2 знаками после запятой
        const formatted = num.toFixed(2);

        return actions.order.create({
          purchase_units: [{
            amount: { value: formatted }
          }]
        });
      },

      onApprove: function (data, actions) {
        return actions.order.capture().then(function () {
          alert('Payment completed');
        });
      },

      onError: function (err) {
        console.log(err);
        alert('Something went wrong. Please try again.');
      }
    }).render('#paypal-button-container');
  </script>
</body>
</html>
